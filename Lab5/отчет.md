



# Отчет по лабораторной работе № 5: Тесты на простоту чисел

## Введение

В данной лабораторной работе рассматриваются несколько вероятностных алгоритмов для проверки чисел на простоту. Эти алгоритмы широко применяются в криптографии, теории чисел и других областях, где требуется быстрая проверка чисел на простоту.
Мы реализовали следующие тесты:
Тест Ферма
Тест Соловея-Штрассена
Тест Миллера-Рабина
Все тесты являются вероятностными, то есть они могут ошибаться с некоторой вероятностью, но точность возрастает при увеличении количества итераций.

### 1. Тест Ферма

Теоретическая основа
Тест Ферма основан на малой теореме Ферма: если n — простое число, то для любого целого a, взаимно простого с n, выполняется равенство:

a ^n−1 ≡1(modn).

Если для какого-либо a это равенство не выполняется, то число n точно составное.

Проверка базовых случаев :
- Если n≤1, то число не является простым.
- Числа 2 и 3 считаются простыми.
- Четные числа (кроме 2) сразу классифицируются как составные.
Основной цикл :
- Выбирается случайное число a в диапазоне [2,n−2].
- Проверяется, что gcd(a,n)=1 (числа должны быть взаимно простыми).
- Вычисляется a ^n−1 modn. Если результат не равен 1, число n составное.
Если после k итераций все проверки пройдены, число считается "вероятно простым".

![image](https://github.com/user-attachments/assets/ec307afe-4fdd-41b8-b2fe-f91645a3f36b)



### 2. Тест Соловея-Штрассена

Теоретическая основа
Тест Соловея-Штрассена объединяет малую теорему Ферма и символ Якоби. Для числа n и случайного a проверяется:

Проверка базовых случаев аналогична тесту Ферма.
Основной цикл :
Вычисляется символ Якоби Jacobi(a,n).
Проверяется условие a^(n−1)/2≡Jacobi(a,n)(modn).
Если условие не выполняется, число n составное.

Символ Якоби обобщает символ Лежандра и используется для определения квадратичного вычета. Он определяется для нечетного положительного модуля n.
Проверка входных данных :
- Модуль n должен быть нечетным и положительным.
Вычисление символа Якоби :
- Используется алгоритм, основанный на свойствах символа Якоби:
- Если a четное, оно делится на 2, и результат корректируется в зависимости от nmod8.
- Если a и n оба сравнимы с 3 по модулю 4, результат умножается на -1.
- Процесс продолжается до тех пор, пока a=/0.
Результат :
Если n=1, возвращается текущий результат.
Если a=0, возвращается 0.


![image](https://github.com/user-attachments/assets/efbf659e-f8d7-4d27-b49b-80eb0e4b2e5c)

![image](https://github.com/user-attachments/assets/09c8a8d1-f227-4023-9185-fbe7af275cd5)



### 3. Тест Миллера-Рабина
Теоретическая основа
Тест Миллера-Рабина является улучшенной версией теста Ферма. Он использует разложение n - 1 = 2^s * r и проверяет условия:

aʳ ≢ 1 (mod n),
a²ʲʳ ≢ -1 (mod n) для всех j ∈ [0, s−1].
Разложение n−1=2^s * r :
- Число n−1 делится на 2 до тех пор, пока не станет нечетным.
Основной цикл :
- Для случайного a вычисляется x=ar modn.
- Если x=1 или x=n−1, число может быть простым.
- В противном случае проверяется последовательность x^2j modn.
Если все проверки пройдены, число считается "вероятно простым".

![image](https://github.com/user-attachments/assets/5a8c5584-9c4f-4351-9e3a-da31031bfe77)



## Заключение

В ходе работы были реализованы три вероятностных теста на простоту чисел: тест Ферма, тест Соловея-Штрассена и тест Миллера-Рабина. Каждый из них имеет свои особенности:

- Тест Ферма прост в реализации, но может давать ошибки для чисел Кармайкла.
- Тест Соловея-Штрассена более надежен, так как использует символ Якоби.
- Тест Миллера-Рабина считается наиболее эффективным и часто применяется в современных криптографических системах.
